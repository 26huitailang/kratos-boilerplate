{
  "swagger": "2.0",
  "info": {
    "title": "auth/v1/auth.proto",
    "version": "version not set"
  },
  "tags": [
    {
      "name": "Auth"
    }
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/api/v1/auth/captcha": {
      "get": {
        "summary": "获取验证码",
        "operationId": "Auth_GetCaptcha",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1GetCaptchaReply"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "captchaType",
            "description": "验证码类型，支持以下类型：\n- \"image\": 图片验证码\n- \"sms\": 短信验证码\n- \"email\": 邮件验证码\n@example \"image\"\n@required",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "target",
            "description": "目标地址，当验证码类型为sms或email时必填\n- sms类型时：填写手机号，格式如 \"+8613812345678\"\n- email类型时：填写邮箱地址，格式如 \"user@example.com\"\n- image类型时：可选，用于指定客户端标识\n@example \"+8613812345678\" or \"user@example.com\"",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "Auth"
        ]
      }
    },
    "/api/v1/auth/captcha/verify": {
      "post": {
        "summary": "验证验证码",
        "operationId": "Auth_VerifyCaptcha",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1VerifyCaptchaReply"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/v1VerifyCaptchaRequest"
            }
          }
        ],
        "tags": [
          "Auth"
        ]
      }
    },
    "/api/v1/auth/lock-status/{username}": {
      "get": {
        "summary": "查询账户锁定状态",
        "operationId": "Auth_LockStatus",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1LockStatusReply"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "username",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "Auth"
        ]
      }
    },
    "/api/v1/auth/login": {
      "post": {
        "summary": "用户登录",
        "operationId": "Auth_Login",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1LoginReply"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/v1LoginRequest"
            }
          }
        ],
        "tags": [
          "Auth"
        ]
      }
    },
    "/api/v1/auth/logout": {
      "post": {
        "summary": "退出登录",
        "operationId": "Auth_Logout",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1LogoutReply"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/v1LogoutRequest"
            }
          }
        ],
        "tags": [
          "Auth"
        ]
      }
    },
    "/api/v1/auth/refresh": {
      "post": {
        "summary": "刷新令牌",
        "operationId": "Auth_RefreshToken",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1RefreshTokenReply"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/v1RefreshTokenRequest"
            }
          }
        ],
        "tags": [
          "Auth"
        ]
      }
    },
    "/api/v1/auth/register": {
      "post": {
        "summary": "用户注册",
        "operationId": "Auth_Register",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/v1RegisterReply"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/v1RegisterRequest"
            }
          }
        ],
        "tags": [
          "Auth"
        ]
      }
    }
  },
  "definitions": {
    "protobufAny": {
      "type": "object",
      "properties": {
        "@type": {
          "type": "string"
        }
      },
      "additionalProperties": {}
    },
    "rpcStatus": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int32"
        },
        "message": {
          "type": "string"
        },
        "details": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/protobufAny"
          }
        }
      }
    },
    "v1GetCaptchaReply": {
      "type": "object",
      "properties": {
        "captchaId": {
          "type": "string",
          "title": "验证码ID"
        },
        "imageData": {
          "type": "string",
          "title": "如果是图片验证码，返回图片内容（base64编码）"
        }
      },
      "title": "获取验证码响应"
    },
    "v1LockStatusReply": {
      "type": "object",
      "properties": {
        "locked": {
          "type": "boolean"
        },
        "unlockTime": {
          "type": "string",
          "format": "int64",
          "title": "解锁时间戳（秒）"
        },
        "failedAttempts": {
          "type": "integer",
          "format": "int32",
          "title": "已失败次数"
        },
        "maxAttempts": {
          "type": "integer",
          "format": "int32",
          "title": "最大允许失败次数"
        }
      },
      "title": "查询账户锁定状态响应"
    },
    "v1LoginReply": {
      "type": "object",
      "properties": {
        "accessToken": {
          "type": "string",
          "title": "访问令牌，用于API调用时的身份验证\n格式为JWT，包含用户信息和权限\n@example \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\""
        },
        "refreshToken": {
          "type": "string",
          "title": "刷新令牌，用于获取新的访问令牌\n有效期通常比访问令牌更长\n@example \"refresh_token_abc123...\""
        },
        "expiresIn": {
          "type": "string",
          "format": "int64",
          "title": "访问令牌过期时间，单位为秒\n表示从当前时间开始多少秒后过期\n@example 3600\n@minimum 1"
        }
      },
      "title": "登录响应\n@description 登录成功后返回的令牌信息"
    },
    "v1LoginRequest": {
      "type": "object",
      "properties": {
        "username": {
          "type": "string",
          "title": "用户名，可以是注册时的用户名、邮箱或手机号\n@example \"john_doe\" or \"john.doe@example.com\" or \"+8613812345678\"\n@required"
        },
        "password": {
          "type": "string",
          "title": "用户密码\n@example \"MyPassword123!\"\n@required\n@format password"
        },
        "captchaId": {
          "type": "string",
          "title": "验证码ID，从GetCaptcha接口获取\n某些情况下可能不需要验证码（如信任设备）\n@example \"captcha_12345\""
        },
        "captchaCode": {
          "type": "string",
          "title": "验证码内容，对应captcha_id的验证码\n@example \"ABCD\""
        },
        "totpCode": {
          "type": "string",
          "title": "TOTP双因子认证码，当用户启用TOTP时必填\n6位数字，从认证器应用生成\n@example \"123456\"\n@pattern \"^[0-9]{6}$\""
        }
      },
      "title": "登录请求\n@description 用户登录请求，支持用户名密码登录和双因子认证"
    },
    "v1LogoutReply": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        }
      },
      "title": "退出登录响应"
    },
    "v1LogoutRequest": {
      "type": "object",
      "title": "退出登录请求"
    },
    "v1RefreshTokenReply": {
      "type": "object",
      "properties": {
        "accessToken": {
          "type": "string"
        },
        "refreshToken": {
          "type": "string"
        },
        "expiresIn": {
          "type": "string",
          "format": "int64"
        }
      },
      "title": "刷新令牌响应"
    },
    "v1RefreshTokenRequest": {
      "type": "object",
      "properties": {
        "refreshToken": {
          "type": "string"
        }
      },
      "title": "刷新令牌请求"
    },
    "v1RegisterReply": {
      "type": "object",
      "properties": {
        "message": {
          "type": "string"
        }
      },
      "title": "注册响应"
    },
    "v1RegisterRequest": {
      "type": "object",
      "properties": {
        "username": {
          "type": "string",
          "title": "用户名，长度3-32位，支持字母、数字、下划线\n不能以数字开头，需要全局唯一\n@example \"john_doe\"\n@required\n@minLength 3\n@maxLength 32\n@pattern \"^[a-zA-Z][a-zA-Z0-9_]*$\""
        },
        "password": {
          "type": "string",
          "title": "密码，长度8-32位，必须包含字母和数字\n建议包含特殊字符以提高安全性\n@example \"MyPassword123!\"\n@required\n@minLength 8\n@maxLength 32\n@format password"
        },
        "email": {
          "type": "string",
          "title": "邮箱地址，用于账户验证和找回密码\n必须是有效的邮箱格式\n@example \"john.doe@example.com\"\n@required\n@format email"
        },
        "phone": {
          "type": "string",
          "title": "手机号码，用于短信验证和账户安全\n支持国际格式，如+86开头的中国手机号\n@example \"+8613812345678\"\n@format phone"
        },
        "captchaId": {
          "type": "string",
          "title": "验证码ID，从GetCaptcha接口获取\n@example \"captcha_12345\"\n@required"
        },
        "captchaCode": {
          "type": "string",
          "title": "验证码内容，用户输入的验证码\n@example \"ABCD\"\n@required"
        }
      },
      "title": "注册请求\n@description 用户注册请求，包含用户基本信息和验证码验证"
    },
    "v1VerifyCaptchaReply": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        }
      },
      "title": "验证验证码响应"
    },
    "v1VerifyCaptchaRequest": {
      "type": "object",
      "properties": {
        "captchaId": {
          "type": "string"
        },
        "captchaCode": {
          "type": "string"
        }
      },
      "title": "验证验证码请求"
    }
  }
}
